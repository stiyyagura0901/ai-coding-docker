services:
  # ============================================
  # CLAUDE CODE SERVICES
  # ============================================
  
  # Claude Code - interactive shell
  claude:
    build:
      context: .
      dockerfile: Dockerfile
    image: ai-coding-docker
    container_name: claude-code
    stdin_open: true
    tty: true
    volumes:
      - .:/app
      - ./.claude-sessions:/home/coder/.claude
    env_file:
      - .env
    working_dir: /app
    command: bash

  # Claude Code - run prompts (print mode)
  claude-prompt:
    build:
      context: .
      dockerfile: Dockerfile
    image: ai-coding-docker
    volumes:
      - .:/app
      - ./.claude-sessions:/home/coder/.claude
    env_file:
      - .env
    working_dir: /app
    profiles:
      - claude
    entrypoint: ["claude", "--dangerously-skip-permissions", "-p"]

  # ============================================
  # OPENCODE SERVICES
  # ============================================
  
  # OpenCode - interactive shell
  opencode:
    build:
      context: .
      dockerfile: Dockerfile
    image: ai-coding-docker
    container_name: opencode
    stdin_open: true
    tty: true
    volumes:
      - .:/app
      - ./.opencode-sessions:/home/coder/.local/share/opencode
    env_file:
      - .env
    working_dir: /app
    command: bash

  # OpenCode - run prompts
  opencode-run:
    build:
      context: .
      dockerfile: Dockerfile
    image: ai-coding-docker
    volumes:
      - .:/app
      - ./.opencode-sessions:/home/coder/.local/share/opencode
    env_file:
      - .env
    working_dir: /app
    profiles:
      - opencode
    entrypoint: ["opencode", "run", "-m", "anthropic/claude-sonnet-4-20250514"]

  # OpenCode - continue session
  opencode-continue:
    build:
      context: .
      dockerfile: Dockerfile
    image: ai-coding-docker
    volumes:
      - .:/app
      - ./.opencode-sessions:/home/coder/.local/share/opencode
    env_file:
      - .env
    working_dir: /app
    profiles:
      - opencode
    entrypoint: ["opencode", "run", "-m", "anthropic/claude-sonnet-4-20250514", "-c"]
